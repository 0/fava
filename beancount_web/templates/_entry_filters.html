<ul class="topmenu">
    <li{% if entry_filters['time'] %} class="selected"{% endif %}>
        <a href="">
            <span>{{ entry_filters['time'] or 'Time' }}</span>
        </a>
        <div class="filter" id="filter-time">
            <div class="inputcontainer">
                <input type="search" class="search-direct-apply" data-url="{{ request.path }}?filter_time=">
            </div>
            <ul>
                {% set time_search_strings = ['this month', '2015-03', 'march 2015', 'mar 2015', 'last year', 'aug last year', '2010-10 - 2014'] %}
                <li class="info">Supports search strings like
                    {% for suggestion in time_search_strings %}
                        <a href="{{ request.path }}?filter_time={% if suggestion != entry_filters['time'] %}{{ suggestion }}{% endif %}" data-filter="{{ suggestion }}">{{ suggestion }}</a>{% if not loop.last %}, {% endif %}
                    {% endfor %}
                </li>

                {% if entry_filters['time'] and entry_filters['time'] not in api.active_years|map('string') %}
                    <li class="suggestion selected" data-filter="{{ entry_filters['time'] }}">
                        <a href="{{ request.path }}?filter_time=">{{ entry_filters['time'] }}</a>
                    </li>
                {% endif %}

                {% for time_ in api.active_years %}
                <li class="suggestion{% if time_|string == entry_filters['time'] %} selected{% endif %}" data-filter="{{ time_ }}">
                    <a href="{{ request.path }}?filter_time={% if time_|string != entry_filters['time'] %}{{ time_ }}{% endif %}">{{ time_ }}</a>
                </li>
                {% endfor %}
            </ul>
        </div>
    </li>
    <li{% if entry_filters['tags']  %} class="selected"{% endif %}>
        <a href="">
            <span>
                {% if entry_filters['tags'] %}
                    {% if entry_filters['tags']|length == 1 %}
                        # {{ entry_filters['tags']|first }}
                    {% else %}
                        Multiple tags
                    {% endif %}
                {% else %}
                    Tag
                {% endif %}
            </span>
        </a>
        <div class="filter">
            <div class="inputcontainer">
                <input type="search">
            </div>
            <ul>
                <li class="info">You can select multiple tags.</li>

                {% for tag in entry_filters['tags'] %}
                <li class="suggestion selected" data-filter="{{ tag|lower }}">
                    <a href="{{ request.path }}?remove_filter_tag={{ tag }}">{{ tag }}</a>
                </li>
                {% endfor %}

            {% for tag in api.active_tags %}
                {% if tag not in entry_filters['tags'] %}
                <li class="suggestion{% if tag in entry_filters['tags'] %} selected{% endif %}" data-filter="{{ tag|lower }}">
                    <a href="{{ request.path }}?{% if tag in entry_filters['tags'] %}remove_filter_tag={{ tag }}{% else %}filter_tag={{ tag }}{% endif %}"># {{ tag }}</a>
                </li>
                {% endif %}
            {% endfor %}
            </ul>
        </div>
    </li>
    <li{% if entry_filters['account'] %} class="selected"{% endif %}>
        <a href="">
            <span>{{ entry_filters['account'] or 'Component' }}</span>
        </a>
        <div class="filter">
            <div class="inputcontainer">
                <input type="search">
            </div>
            <ul>
                {% for account in api.all_accounts %}
                <li class="suggestion{% if account.full_name == entry_filters['account'] %} selected{% endif %}" data-filter="{{ account.full_name|lower }}">
                    <a href="{{ request.path }}?filter_account={% if account.full_name != entry_filters['account'] %}{{ account.full_name }}{% endif %}">
                        {% for i in range(account.depth) %}&ndash;{% endfor %}&nbsp;{{ account.name }}
                    </a>
                </li>
                {% endfor %}
            </ul>
        </div>
    </li>
    <li{% if entry_filters['payees']  %} class="selected"{% endif %}>
        <a href="">
            <span>
                {% if entry_filters['payees'] %}
                    {% if entry_filters['payees']|length == 1 %}
                        {{ entry_filters['payees']|first }}
                    {% else %}
                        Multiple payees
                    {% endif %}
                {% else %}
                    Payee
                {% endif %}
            </span>
        </a>
        <div class="filter">
            <div class="inputcontainer">
                <input type="search">
            </div>
            <ul>
                <li class="info">You can select multiple payees.</li>

                {% for payee in entry_filters['payees'] %}
                <li class="suggestion selected" data-filter="{{ payee|lower }}">
                    <a href="{{ request.path }}?remove_filter_payee={{ payee }}">{{ payee }}</a>
                </li>
                {% endfor %}

            {% for payee in api.active_payees %}
                {% if payee and payee not in entry_filters['payees'] %} {# This excludes empty payees #}
                <li class="suggestion" data-filter="{{ payee|lower }}">
                    <a href="{{ request.path }}?filter_payee={{ payee }}">{{ payee }}</a>
                </li>
                {% endif %}
            {% endfor %}
            </ul>
        </div>
    </li>
</ul>
